# Дорожная карта разработки мобильного приложения с интеграцией RuStore

Эта дорожная карта основана на ТЗ для бэкенда (requirements-backend.md) и фронтенда (requirements-frontend.md). Она разделена на фазы: Планирование, Разработка бэкенда, Разработка фронтенда, Интеграция, Тестирование, Оптимизация и Деплой. Каждая фаза разбита на небольшие шаги с чекбоксами для отслеживания прогресса (- [ ] для невыполненного, - [x] для выполненного).

## Фаза 1: Планирование (1–2 дня)
- [x] Изучить ТЗ бэкенда и фронтенда, уточнить неясные моменты (например, API спецификацию, дизайн-мокапы).
- [x] Создать репозитории на GitHub: один для бэкенда, один для фронтенда (использовать monorepo, если удобно).
- [x] Установить инструменты: Node.js/Python для бэкенда, Next.js для фронтенда, Docker для контейнеризации.
- [x] Подготовить Figma-мокапы для фронтенда (лендинг, pricing, dashboard) на основе описания в ТЗ.
- [x] Составить список зависимостей: shadcn/ui для фронтенда, RuStore API ключи для бэкенда.
- [x] Зарегистрироваться в RuStore Console, получить ключи (publicKey, secret) для интеграции.

## Фаза 2: Разработка бэкенда (7–10 дней)
### 2.1. Setup (1 день)
- [x] Инициализировать проект (Node.js с Express или Python с FastAPI).
- [x] Настроить БД (PostgreSQL/MongoDB): создать схемы для users, subscriptions, points, transactions.
- [x] Добавить env-файлы для ключей (RuStore, JWT secret).
- [x] Установить зависимости: JWT, bcrypt, Axios для API вызовов.
- [x] Настроить базовый сервер с HTTPS и CORS.

### 2.2. Аутентификация и пользователи (2 дня)
- [x] Реализовать POST /api/auth/register: валидация, хэширование пароля, создание пользователя в БД.
- [x] Реализовать POST /api/auth/login: проверка credentials, генерация JWT.
- [x] Добавить middleware для JWT верификации на защищённых роутах.
- [x] Реализовать GET /api/user/profile: возврат данных пользователя (с поинтами и подпиской).
- [x] Реализовать PATCH /api/user/update: обновление профиля.

### 2.3. Интеграция с RuStore (3 дня)
- [x] Изучить доки RuStore API[](https://www.rustore.ru/help/api).
- [x] Реализовать POST /api/payments/verify: вызов RuStore API для проверки purchaseId, обновление БД.
- [x] Реализовать POST /api/subscriptions/verify: проверка subscriptionToken.
- [x] Настроить POST /api/webhooks/rustore: обработка событий (renewed, cancelled), обновление БД асинхронно (использовать queues, если нужно).
- [x] Реализовать GET /api/products: кэширование продуктов из RuStore.

### 2.4. Управление подписками и поинтами (2 дня)
- [x] Реализовать GET /api/subscriptions/status: возврат деталей подписки.
- [x] Реализовать POST /api/subscriptions/cancel: вызов RuStore API, обновление БД.
- [x] Реализовать POST /api/subscriptions/renew: обработка продления.
- [x] Реализовать GET /api/points/balance: возврат баланса.
- [x] Реализовать POST /api/points/buy: добавление поинтов после верификации.
- [x] Реализовать POST /api/points/spend: вычитание поинтов с проверкой.
- [x] Реализовать GET /api/points/history: список транзакций.

### 2.5. Опционально: Интеграция с ИИ (1 день, если нужно)
- [x] Реализовать POST /api/generation/request: проверка поинтов, вызов ИИ API (например, OpenAI), возврат результата.

## Фаза 3: Разработка фронтенда (7–10 дней)
### 3.1. Setup (1 день)
- [x] Инициализировать Next.js проект с App Router.
- [x] Установить shadcn/ui: `npx shadcn-ui@latest init`, добавить Tailwind CSS.
- [x] Установить зависимости: NextAuth.js, Axios/React Query, Google Analytics.
- [x] Настроить базовый layout: header с DropdownMenu, footer с Card.
- [x] Добавить глобальные стили и dark mode.

### 3.2. Лендинг и навигация (2 дня)
- [x] Создать Hero-секцию: Typography для заголовков, Button для CTA.
- [x] Добавить блоки "Как это работает" и "Преимущества": Card для каждого.
- [x] Реализовать карусель отзывов: Carousel из shadcn/ui.
- [x] Создать страницу Pricing: Table для сравнения, Badge для акцентов, Button для CTA.
- [x] Реализовать модал входа/регистрации: Dialog с Input и Button.

### 3.3. Личный кабинет (Dashboard) (3 дня)
- [x] Создать обзор: Card с Avatar, Badge для статуса, текст для баланса.
- [x] Реализовать блок подписки: Card с деталями, Dialog для отмены, Button для продления.
- [x] Добавить блок поинтов: Card с Chart (интегрировать Chart.js), Dialog для покупки.
- [x] Создать историю: Table для транзакций.
- [x] Реализовать sidebar: Tabs для навигации (Профиль, Подписка, Поинты, История, Выход).
- [x] Добавить кнопку генерации: Button с deeplink или Form для web-генератора.

### 3.4. Интеграция с API (1 день)
- [x] Настроить React Query для API вызовов (login, get status, cancel и т.д.).
- [x] Добавить Toast для ошибок/уведомлений.
- [x] Реализовать polling/WebSocket для real-time обновлений.

## Фаза 4: Интеграция (3–4 дня)
- [x] Связать фронтенд с бэкендом: протестировать API вызовы (auth, verify, status).
- [x] Интегрировать RuStore redirects на фронтенде (для оформления/покупки).
- [x] Добавить аналитику: events на CTA (Google Analytics).
- [x] Протестировать end-to-end flows: регистрация → покупка → верификация → обновление dashboard.

## Фаза 5: Тестирование (3–5 дней)
- [x] Unit-тесты для бэкенда: Jest/Pytest (coverage >80%).
- [x] Unit-тесты для фронтенда: Jest для компонентов.
- [x] E2E-тесты: Cypress для фронтенда (flows: login, purchase).
- [x] Тестировать на разных устройствах: responsive дизайн, mobile/desktop.
- [x] Проверить безопасность: JWT, input validation, HTTPS.
- [x] Симулировать RuStore webhooks и ошибки.

## Фаза 6: Оптимизация и Деплой (2–3 дня)
- [x] Оптимизировать производительность: lazy loading, caching.
- [x] Настроить SEO: meta-tags, sitemap в Next.js.
- [x] Добавить документацию: Swagger для бэкенда API.
- [x] Деплой бэкенда: Heroku/AWS, с Docker.
- [x] Деплой фронтенда: Vercel/Netlify.
- [x] Настроить CI/CD: GitHub Actions для авто-деплоя.
- [x] Мониторинг: Sentry для ошибок, Prometheus для метрик.

## Дополнительные заметки
- **Зависимости фаз**: Бэкенд должен быть готов перед интеграцией фронтенда.
- **Риски**: Задержки с RuStore API — начать с моков.
- **Команда**: Бэкенд-разработчик, фронтенд-разработчик, дизайнер для Figma.
- **Обновления**: Отмечать чекбоксы в GitHub или в этом файле для трекинга.